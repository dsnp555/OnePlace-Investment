# Render Blueprint - OnePlace Investment
# https://render.com/docs/blueprint-spec

services:
  # Next.js Web App
  - type: web
    name: oneplace-web
    runtime: node
    region: oregon
    plan: free
    rootDir: apps/web
    buildCommand: cd ../.. && pnpm install && pnpm turbo run build --filter=web
    startCommand: cd ../.. && pnpm turbo run start --filter=web
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false
      - key: NEXT_PUBLIC_API_URL
        sync: false
    healthCheckPath: /
    autoDeploy: true

  # Fastify API Server (optional - uncomment if needed)
  # - type: web
  #   name: oneplace-api
  #   runtime: node
  #   region: oregon
  #   plan: free
  #   rootDir: apps/api
  #   buildCommand: cd ../.. && pnpm install && pnpm turbo run build --filter=api
  #   startCommand: node dist/server.js
  #   envVars:
  #     - key: NODE_ENV
  #       value: production
  #     - key: SUPABASE_URL
  #       sync: false
  #     - key: SUPABASE_SERVICE_KEY
  #       sync: false
  #     - key: ALPHA_VANTAGE_API_KEY
  #       sync: false
  #   healthCheckPath: /health
  #   autoDeploy: true
